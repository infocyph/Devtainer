<VirtualHost *:80>
    # Redirect all HTTP traffic to https://newdomain.com
    ServerName example.com
    ServerAlias www.example.com

    Alias /.well-known/acme-challenge/ /var/www/certbot/.well-known/acme-challenge/
    <Directory /var/www/certbot/.well-known/acme-challenge/>
        AllowOverride None
        Options None
        Require all granted
    </Directory>

    RewriteEngine On
    RewriteRule ^/?(.*) https://newdomain.com/$1 [R=301,L]

    # No logs for redirection
</VirtualHost>

<VirtualHost *:443>
    # Redirect all HTTPS traffic to https://newdomain.com
    ServerName example.com
    ServerAlias www.example.com

    # SSL Configuration
    SSLEngine on

    # SSL certificate and key
    SSLCertificateFile /etc/letsencrypt/live/example.com/cert.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem
    SSLCertificateChainFile /etc/letsencrypt/live/example.com/chain.pem

    # SSL Protocol and Cipher Settings
    SSLProtocol all -SSLv2 -SSLv3
    SSLCipherSuite HIGH:!aNULL:!MD5

    RewriteEngine On
    RewriteRule ^/?(.*) https://newdomain.com/$1 [R=301,L]

    # No logs for redirection
</VirtualHost>
